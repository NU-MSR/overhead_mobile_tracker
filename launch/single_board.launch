<launch>
  <arg name="camera_enable" default="true"/>
  <arg name="camera_device" default="/dev/video1"/>
  <arg name="camera_info" default="file://$(find overhead_mobile_tracker)/launch/overhead_tracker_camera.yaml"/>
  <arg name="camera_frame_id" default="overhead_cam_frame"/>
  <arg name="camera_width" default="1280"/>
  <arg name="camera_height" default="720" />
  <arg name="camera_fps"  default="30"/>

  <arg name="result_display" default="true"/>
  <arg name="result_autosize" default="true"/>
  <arg name="result_draw_markers" default="false" />
  <arg name="result_draw_markers_cube" default="false" />
  <arg name="result_draw_markers_axis" default="false" />

  <arg name="video_namespace" default="/overhead_camera"/>
  <arg name="video_image_topic" default="image_rect_color"/>
  <arg name="video_info_topic" default="camera_info"/>
  <arg name="video_rectified" default="true" />

  <arg name="board_config" default="$(find overhead_mobile_tracker)/data/board.yml" />
  <arg name="board_frame_id" default="board1" />
  <arg name="marker_size" default="0.045" />
  <arg name="publish_tf" default="false" />


  <group if="$(arg camera_enable)">
	<node ns="$(arg video_namespace)" pkg="image_proc" type="image_proc" name="image_proc" />
	<!-- <node ns="$(arg video_namespace)" pkg="usb_cam" type="usb_cam_node" name="overhead_camera" output="screen"> -->
	<!--   <param name="image_width" type="int" value="$(arg camera_width)" /> -->
	<!--   <param name="image_height" type="int" value="$(arg camera_height)" /> -->
	<!--   <param name="framerate" type="int" value="$(arg camera_fps)" /> -->
	<!--   <param name="pixel_format" type="string" value="mjpeg" /> -->
	<!--   <param name="camera_frame_id" type="string" value="/$(arg camera_frame_id)" /> -->
	<!--   <param name="video_device" type="string" value="$(arg camera_device)" /> -->
	<!--   <param name="camera_name" type="string" value="overhead_tracker_camera"/> -->
	<!--   <param name="camera_info_url" type="string" value="$(arg camera_info)" /> -->
	<!-- </node> -->
	<node ns="$(arg video_namespace)" pkg="uvc_camera" type="uvc_camera_node" name="uvc_camera" output="screen">
	  <param name="width" type="int" value="$(arg camera_width)" />
	  <param name="height" type="int" value="$(arg camera_height)" />
	  <param name="fps" type="int" value="$(arg camera_fps)" />
	  <param name="frame_id" type="string" value="/$(arg camera_frame_id)" />
	  <param name="device" type="string" value="$(arg camera_device)" />
	  <param name="camera_info_url" type="string" value="$(arg camera_info)" />
	  <param name="name" value="overhead_tracker_camera)" />
	</node>
  </group>

  <node ns="/" pkg="ar_sys" type="single_board" name="ar_single_board" output="screen">
  	<remap from="/camera_info" to="$(arg video_namespace)/$(arg video_info_topic)" />
  	<remap from="/image" to="$(arg video_namespace)/$(arg video_image_topic)" />

  	<param name="image_is_rectified" type="bool" value="$(arg video_rectified)"/>
  	<param name="board_config" type="string" value="$(arg board_config)"/>
  	<param name="board_frame" type="string" value="/$(arg board_frame_id)" />
  	<param name="marker_size" type="double" value="$(arg marker_size)"/>
  	<param name="draw_markers" type="bool" value="$(arg result_draw_markers)" />
  	<param name="draw_markers_cube" type="bool" value="$(arg result_draw_markers_cube)" />
  	<param name="draw_markers_axis" type="bool" value="$(arg result_draw_markers_axis)" />
    <param name="publish_tf" value="$(arg publish_tf)" />
  </node>

  <node ns="/" pkg="topic_tools" type="relay" name="ar_single_board_relay" args="/ar_single_board/transform /arsys_single_board/transform" />

  <group if="$(arg result_display)">
  	<node ns="/" pkg="image_view" type="image_view" name="image_view" output="screen">
  	  <remap from="image" to="/ar_single_board/result" />
  	  <param name="autosize" type="bool" value="$(arg result_autosize)" />
  	</node>
  </group>

</launch>
